version: 3

vars:
  LOCAL_BIN:
    sh: realpath ./bin

tasks:
  build:
    desc: Build shell scripts
    silent: false
    sources:
      - "./shell/*"
    cmds:
      - for: sources
        cmd: cp {{ .ITEM }} {{ .LOCAL_BIN }}/{{ base .ITEM }}

  lint:
    desc: Lint shell scripts
    cmds:
      - |
        if command -v shellcheck >/dev/null 2>&1; then
          find bin shell -name "*.sh" -type f -exec shellcheck {} \;
          find bin shell -type f -exec file {} \; | grep -E "(shell|bash|zsh)" | cut -d: -f1 | xargs shellcheck
        else
          echo "shellcheck not installed. Install with: brew install shellcheck"
        fi

  organize:
    desc: Move shell scripts from bin/ to shell/ directory
    cmds:
      - |
        for script in bin/*.sh bin/*.py; do
          [ -f "$script" ] && mv "$script" shell/ && echo "Moved $(basename $script) to shell/"
        done